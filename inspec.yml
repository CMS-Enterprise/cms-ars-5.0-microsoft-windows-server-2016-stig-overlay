name: cms-ars-5.0-microsoft-windows-server-2016-stig-overlay
title: cms-ars-5.0-microsoft-windows-server-2016-stig-overlay
maintainer: CMS SAF Team
copyright: 
copyright_email: saf@cms.hhs.gov
license: Apache-2.0
summary: CMS ARS 5.0 Overlay InSpec Validation Profile for Windows Server 2016 STIG
version: 1.7.0
inspec_version: ">= 4.0"

depends:
  - name: microsoft-windows-server-2016-stig-baseline
    url: https://github.com/mitre/microsoft-windows-server-2016-stig-baseline/archive/parameterize.tar.gz

inputs:
  - name: system_categorization
    desc: "Selected system baseline based on the environment variable"
    type: String
    value: <%= ENV['BASELINE'].nil? ? 'Moderate (Default)' : ENV['BASELINE'] %>

  - name: org_name
    desc: "Name of the organization running this profile"
    type: Hash
    value:
      acronym: "CMS"
      full_form: "Centers for Medicare & Medicaid Services"
    profile: microsoft-windows-server-2016-stig-baseline

  - name: temporary_account_period # V-73283
    desc: "List the number of days that temporary accounts remain active for"
    type: Numeric
    profile: microsoft-windows-server-2016-stig-baseline
    <% if ['High-HVA', 'Moderate-HVA', 'Low-HVA'].include? ENV['BASELINE'] %>
    value: 0.5
    <% elsif ENV['BASELINE'] == 'High' %>
    value: 30
    <% elsif ENV['BASELINE'] == 'Moderate' %>
    value: 60
    <% elsif ENV['BASELINE'].nil? %>
    value: 60
    <% end %>

  - name: temporary_account_period_phrase # V-73283
    desc: "List the number of hours/days that temporary accounts remain active for"
    type: String
    profile: microsoft-windows-server-2016-stig-baseline
    <% if ['High-HVA', 'Moderate-HVA', 'Low-HVA'].include? ENV['BASELINE'] %>
    value: "12 hours"
    <% elsif ENV['BASELINE'] == 'High' %>
    value: "30 days"
    <% elsif ENV['BASELINE'] == 'Moderate' %>
    value: "60 days"
    <% elsif ENV['BASELINE'].nil? %>
    value: "60 days"
    <% end %>

  - name: emergency_account_period # V-73285
    desc: "List the number of days that temporary accounts remain active for"
    type: Numeric
    profile: microsoft-windows-server-2016-stig-baseline
    <% if ['High-HVA', 'Moderate-HVA', 'Low-HVA'].include? ENV['BASELINE'] %>
    value: 0.5
    <% elsif ['High', 'Moderate'].include? ENV['BASELINE'] %>
    value: 1
    <% elsif ENV['BASELINE'].nil? %>
    value: 1
    <% end %>

  - name: emergency_account_period_phrase # V-73285
    desc: "List the number of hours/days that temporary accounts remain active for"
    type: String
    profile: microsoft-windows-server-2016-stig-baseline
    <% if ['High-HVA', 'Moderate-HVA' 'Low-HVA'].include? ENV['BASELINE'] %>
    value: "12 hours"
    <% elsif ['High', 'Moderate'].include? ENV['BASELINE'] %>
    value: "24 hours"
    <% elsif ENV['BASELINE'].nil? %>
    value: "24 hours"
    <% end %>

  - name: pass_lock_duration # V-73309
    desc: "List the number of minutes for account lockout duration"
    type: Numeric
    profile: microsoft-windows-server-2016-stig-baseline
    <% if ['High-HVA', 'High'].include? ENV['BASELINE'] %>
    value: 0
    <% elsif ['Moderate-HVA', 'Moderate'].include? ENV['BASELINE'] %>
    value: 60
    <% elsif ['Low-HVA', 'Low'].include? ENV['BASELINE'] %>
    value: 15
    <% elsif ENV['BASELINE'].nil? %>
    value: 60
    <% end %>

  - name: max_pass_lockout # V-73311
    desc: "Account lockout threshold based on invalid logon attempts"
    type: Numeric
    profile: microsoft-windows-server-2016-stig-baseline
    <% if ['High', 'High-HVA'].include? ENV['BASELINE'] %>
    value: 3
    <% elsif ['Moderate', 'Moderate-HVA', 'Low', 'Low-HVA'].include? ENV['BASELINE'] %>
    value: 5
    <% elsif ENV['BASELINE'].nil? %>
    value: 5
    <% end %>

  - name: pass_lock_time # V-73313
    desc: "List the number of minutes before a session is locked out"
    type: Numeric
    value: 120
    profile: microsoft-windows-server-2016-stig-baseline

  - name: app_password_age # V-73231
    desc: "Set the number of days that manually managed application account passwords must be changed"
    type: Numeric
    profile: microsoft-windows-server-2016-stig-baseline
    <% if ['High-HVA', 'Moderate-HVA', 'Low-HVA'].include? ENV['BASELINE'] %>
    value: 60
    <% end %>
 
  - name: maximum_password_age_machine # V-73641
    desc: "Set the machine account maximum password age stated by your organiztion"
    type: Numeric
    profile: microsoft-windows-server-2016-stig-baseline
    <% if ['High-HVA', 'Moderate-HVA', 'Low-HVA'].include? ENV['BASELINE'] %>
    value: 60
    <% end %>

  - name: unused_account_age # V-73259
    desc: "Set the maximum age in days for unused accounts stated by your organization"
    type: Numeric
    profile: microsoft-windows-server-2016-stig-baseline
    <% if ['High-HVA', 'High'].include? ENV['BASELINE'] %>
    value: 30
    <% elsif ['Moderate-HVA', 'Moderate'].include? ENV['BASELINE'] %>
    value: 60
    <% elsif ENV['BASELINE'].nil? %>
    value: 60
    <% end %>

  - name: minimum_password_length_manual # V-73229
    desc: "Set the minimum password length for manually managed applications stated by your organization"
    type: Numeric
    profile: microsoft-windows-server-2016-stig-baseline
    <% if ['High-HVA', 'Moderate-HVA', 'Low-HVA'].include? ENV['BASELINE'] %>
    value: 20
    <% elsif ['High', 'Moderate', 'Low'].include? ENV['BASELINE'] %>
    value: 15 # Same as the baseline parameter
    <% elsif ENV['BASELINE'].nil? %>
    value: 15
    <% end %>

  - name: minimum_password_length # V-73321
    desc: "Set the minimum password length stated by your organization"
    type: Numeric
    profile: microsoft-windows-server-2016-stig-baseline
    <% if ['High-HVA', 'Moderate-HVA', 'Low-HVA'].include? ENV['BASELINE'] %>
    value: 20
    <% elsif ['High', 'Moderate', 'Low'].include? ENV['BASELINE'] %>
    value: 15
    <% elsif ENV['BASELINE'].nil? %>
    value: 15
    <% end %>  

  # V-73319 minimum_password_age input value is the same as the baseline parameter of 1
  # V-73317 maximum_password_age input value is the same as the baseline parameter of 60
  
  - name: password_history_size # V-73315
    desc: "Set the password history size stated by your organization"
    type: Numeric
    profile: microsoft-windows-server-2016-stig-baseline
    <% if ['High-HVA', 'Moderate-HVA', 'Low-HVA'].include? ENV['BASELINE'] %>
    value: 24 # Max value to disallow password reuse
    <% end %>

  - name: maximum_idle_time #  V-73387
    desc: "Set the maximum connection idle time stated by your organization"
    type: Numeric
    profile: microsoft-windows-server-2016-stig-baseline
    <% if ['High-HVA', 'High', 'Moderate-HVA', 'Moderate'].include? ENV['BASELINE'] %>
    value: 30
    <% elsif ENV['BASELINE'].nil? %>
    value: 30
    <% end %>

  - name: maximum_idle_time_phrase #  V-73387
    desc: "Set the maximum connection idle time stated by your organization"
    type: String
    profile: microsoft-windows-server-2016-stig-baseline
    <% if ['High-HVA', 'High', 'Moderate-HVA', 'Moderate'].include? ENV['BASELINE'] %>
    value: "30 minutes"
    <% elsif ENV['BASELINE'].nil? %>
    value: "30 minutes"
    <% end %>

  - name: legal_notice_text # V-73647
    type: string
    profile: microsoft-windows-server-2016-stig-baseline
    value: "* This warning banner provides privacy and security notices consistent with applicable federal laws, directives, and other federal guidance for accessing this Government system, which includes (1) this computer network, (2) all computers connected to this network, and (3) all devices and storage media attached to this network or to a computer on this network.
    * This system is provided for Government authorized use only.
    * Unauthorized or improper use of this system is prohibited and may result in disciplinary action and/or civil and criminal penalties.
    * Personal use of social media and networking sites on this system is limited as to not interfere with official work duties and is subject to monitoring.
    * By using this system, you understand and consent to the following:  - The Government may monitor, record, and audit your system usage, including usage of personal devices and email systems for official duties or to conduct HHS business. Therefore, you have no reasonable expectation of privacy regarding any communication or data transiting or stored on this system. At any time, and for any lawful Government purpose, the government may monitor, intercept, and search and seize any communication or data transiting or stored on this system.  - Any communication or data transiting or stored on this system may be disclosed or used for any lawful Government purposes."

  - name: legal_notice_caption # V-73649
    desc: "Use the default values or add an organization-defined legal notice caption"
    type: Array
    value:
      - "CMS Notice and Consent Banner"
      - "US Department of Health and Human Services Warning Statement"
    profile: microsoft-windows-server-2016-stig-baseline


  - name: overlay_controls
    desc: 'List of inapplicable controls/requirements in ARS 5.0 based on the system categorization'
    type: Array
    <% if ENV['BASELINE'] == 'High-HVA' %>
    value: []
    <% elsif ENV['BASELINE'] == 'High' %>
    value: []
    <% elsif ENV['BASELINE'] == 'Moderate-HVA' %>
    value: []
    <% elsif ENV['BASELINE'] == 'Moderate' || ENV['BASELINE'].nil? %> # Default
    value: 
      - "V-73487" # SC-03 Requirement NA
      - "V-73495" # SC-03 Requirement NA
      - "V-73709" # SC-03 Requirement NA
      - "V-73711" # SC-03 Requirement NA
      - "V-73715" # SC-03 Requirement NA
      - "V-73717" # SC-03 Requirement NA
      - "V-73721" # SC-03 Requirement NA
    <% elsif ENV['BASELINE'] == 'Low-HVA' %>
    value:
      - "V-73219" # AC-06(10) Requirement NA
      - "V-73221" # AC-06(10) Requirement NA
      - "V-73255" # AC-06(10) Requirement NA
      - "V-73369" # AC-06(10) Requirement NA
      - "V-73371" # AC-06(10) Requirement NA
      - "V-73373" # AC-06(10) Requirement NA
      - "V-73375" # AC-06(10) Requirement NA
      - "V-73377" # AC-06(10) Requirement NA
      - "V-73387" # SC-10 Requirement NA
      - "V-73677" # AC-06(10) Requirement NA
      - "V-73729" # AC-06(10) Requirement NA
      - "V-73735" # AC-06(10) Requirement NA
      - "V-73737" # AC-06(10) Requirement NA
      - "V-73743" # AC-06(10) Requirement NA
      - "V-73745" # AC-06(10) Requirement NA
      - "V-73747" # AC-06(10) Requirement NA
      - "V-73749" # AC-06(10) Requirement NA
      - "V-73751" # AC-06(10) Requirement NA
      - "V-73753" # AC-06(10) Requirement NA
      - "V-73755" # AC-06(10) Requirement NA
      - "V-73777" # AC-06(10) Requirement NA
      - "V-73779" # AC-06(10) Requirement NA
      - "V-73781" # AC-06(10) Requirement NA
      - "V-73783" # AC-06(10) Requirement NA
      - "V-73785" # AC-06(10) Requirement NA
      - "V-73787" # AC-06(10) Requirement NA
      - "V-73789" # AC-06(10) Requirement NA
      - "V-73791" # AC-06(10) Requirement NA
      - "V-73795" # AC-06(10) Requirement NA
      - "V-73797" # AC-06(10) Requirement NA
      - "V-73799" # AC-06(10) Requirement NA
      - "V-73801" # AC-06(10) Requirement NA
      - "V-73803" # AC-06(10) Requirement NA
      - "V-73645" # AC-11 Requirement NA
      - "V-73725" # AC-11 Requirement NA
      - "V-73723" # AC-11(01) Requirement NA
      - "V-73659" # AC-12 SC-10 Requirement NA
      - "V-73773" # AC-17(01) Requirement NA
      - "V-73775" # AC-17(01) Requirement NA
      - "V-73511" # AU-03(01) Requirement NA
      - "V-73591" # AU-03(01) Requirement NA
      - "V-73545" # CM-07(02) Requirement NA
      - "V-73547" # CM-07(02) Requirement NA
      - "V-73549" # CM-07(02) Requirement NA
      - "V-73235" # CM-07(05) Requirement NA
      - "V-73611" # IA-05(02) Requirement NA
      - "V-73613" # IA-05(02) Requirement NA
      - "V-73615" # IA-05(02) Requirement NA
      - "V-73699" # IA-05(02) Requirement NA
      - "V-73569" # SC-04 Requirement NA
      - "V-73675" # SC-04 Requirement NA
      - "V-73689" # SC-10 Requirement NA
      - "V-73281" # SI-02(02) Requirement NA
      - "V-73561" # SI-16 Requirement NA
    <% elsif ENV['BASELINE'] == 'Low' %>
    value:
      - "V-73283" # AC-02(02) Requirement NA
      - "V-73285" # AC-02(02) Requirement NA
      - "V-73219" # AC-06(10) Requirement NA
      - "V-73221" # AC-06(10) Requirement NA
      - "V-73255" # AC-06(10) Requirement NA
      - "V-73369" # AC-06(10) Requirement NA
      - "V-73371" # AC-06(10) Requirement NA
      - "V-73373" # AC-06(10) Requirement NA
      - "V-73375" # AC-06(10) Requirement NA
      - "V-73377" # AC-06(10) Requirement NA
      - "V-73677" # AC-06(10) Requirement NA
      - "V-73729" # AC-06(10) Requirement NA
      - "V-73735" # AC-06(10) Requirement NA
      - "V-73737" # AC-06(10) Requirement NA
      - "V-73743" # AC-06(10) Requirement NA
      - "V-73745" # AC-06(10) Requirement NA
      - "V-73747" # AC-06(10) Requirement NA
      - "V-73749" # AC-06(10) Requirement NA
      - "V-73751" # AC-06(10) Requirement NA
      - "V-73753" # AC-06(10) Requirement NA
      - "V-73755" # AC-06(10) Requirement NA
      - "V-73777" # AC-06(10) Requirement NA
      - "V-73779" # AC-06(10) Requirement NA
      - "V-73781" # AC-06(10) Requirement NA
      - "V-73783" # AC-06(10) Requirement NA
      - "V-73785" # AC-06(10) Requirement NA
      - "V-73787" # AC-06(10) Requirement NA
      - "V-73789" # AC-06(10) Requirement NA
      - "V-73791" # AC-06(10) Requirement NA
      - "V-73795" # AC-06(10) Requirement NA
      - "V-73797" # AC-06(10) Requirement NA
      - "V-73799" # AC-06(10) Requirement NA
      - "V-73801" # AC-06(10) Requirement NA
      - "V-73803" # AC-06(10) Requirement NA
      - "V-73645" # AC-11 Requirement NA
      - "V-73725" # AC-11 Requirement NA
      - "V-73723" # AC-11(01) Requirement NA
      - "V-73773" # AC-17(01) Requirement NA
      - "V-73775" # AC-17(01) Requirement NA
      - "V-73573" # AC-17(02) Requirement NA
      - "V-73575" # AC-17(02) Requirement NA
      - "V-73511" # AU-03(01) Requirement NA
      - "V-73591" # AU-03(01) Requirement NA
      - "V-73545" # CM-07(02) Requirement NA
      - "V-73547" # CM-07(02) Requirement NA
      - "V-73549" # CM-07(02) Requirement NA
      - "V-73235" # CM-07(05) Requirement NA
      - "V-73611" # IA-05(02) Requirement NA
      - "V-73613" # IA-05(02) Requirement NA
      - "V-73615" # IA-05(02) Requirement NA
      - "V-73699" # IA-05(02) Requirement NA
      - "V-73709" # SC-03 Requirement NA
      - "V-73711" # SC-03 Requirement NA
      - "V-73715" # SC-03 Requirement NA
      - "V-73717" # SC-03 Requirement NA
      - "V-73721" # SC-03 Requirement NA
      - "V-73267" # SC-04 Requirement NA
      - "V-73379" # SC-04 Requirement NA
      - "V-73569" # SC-04 Requirement NA
      - "V-73675" # SC-04 Requirement NA
      - "V-73633" # SC-08 SC-08(01) Requirement NA
      - "V-73635" # SC-08 SC-08(01) Requirement NA
      - "V-73637" # SC-08 SC-08(01) Requirement NA
      - "V-73643" # SC-08 SC-08(01) Requirement NA
      - "V-73653" # SC-08 SC-08(01) Requirement NA
      - "V-73655" # SC-08 SC-08(01) Requirement NA
      - "V-73661" # SC-08 SC-08(01) Requirement NA
      - "V-73663" # SC-08 SC-08(01) Requirement NA
      - "V-73659" # SC-10 AC-12 Requirement NA
      - "V-73387" # SC-10 Requirement NA
      - "V-73689" # SC-10 Requirement NA
      - "V-73273" # SC-28 SC-28(01) Requirement NA
      - "V-73281" # SI-02(02) Requirement NA
      - "V-73561" # SI-16 Requirement NA
    <% end %>